name: Jules Issue Handler

on:
  issues:
    types: [opened]

jobs:
  handle-issue:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
      pull-requests: write
    steps:
      - uses: google-labs-code/jules-invoke@v1
        with:
          jules_api_key: ${{ secrets.JULES_API_KEY }}
          prompt: |
            You are an AI software engineer.
            Please address the issue described below.

            Issue Title: ${{ github.event.issue.title }}
            Issue Body: ${{ github.event.issue.body }}

            Your goal is to resolve this issue.
            If the issue requires code changes:
            1. Analyze the codebase.
            2. Make the necessary changes.
            3. Create a Pull Request.
            4. In the Pull Request description, include "Fixes #${{ github.event.issue.number }}" to ensure the issue is automatically closed when the PR is merged.

            If the issue can be resolved without code changes (e.g. answering a question), please do so by commenting on the issue and then closing it.
